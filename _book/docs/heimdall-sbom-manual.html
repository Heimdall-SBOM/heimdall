
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Heimdall SBOM Manual · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.8">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="heimdall-validate-manual.html" />
    
    
    <link rel="prev" href="cmake_module.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="architecture.html">
            
                <a href="architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="cmake_module.html">
            
                <a href="cmake_module.html">
            
                    
                    CMake Module
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="heimdall-sbom-manual.html">
            
                <a href="heimdall-sbom-manual.html">
            
                    
                    Heimdall SBOM Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="heimdall-validate-manual.html">
            
                <a href="heimdall-validate-manual.html">
            
                    
                    Heimdall Validate Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="ada_SBOM.html">
            
                <a href="ada_SBOM.html">
            
                    
                    Ada SBOM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="ci-workflow.md">
            
                <span>
            
                    
                    CI Workflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="heimdall-developers-guide.md">
            
                <span>
            
                    
                    Heimdall Developers Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="heimdall-users-guide.md">
            
                <span>
            
                    
                    Heimdall Users Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="llvm-compatibility.html">
            
                <a href="llvm-compatibility.html">
            
                    
                    LLVM Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="multi-standard-support.html">
            
                <a href="multi-standard-support.html">
            
                    
                    Multi-Standard Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="sbom_validation_guide.html">
            
                <a href="sbom_validation_guide.html">
            
                    
                    SBOM Validation Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="setup_usage.html">
            
                <a href="setup_usage.html">
            
                    
                    Setup Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="testing-heimdall.html">
            
                <a href="testing-heimdall.html">
            
                    
                    Testing Heimdall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="usage.html">
            
                <a href="usage.html">
            
                    
                    Usage
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Heimdall SBOM Manual</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="heimdall-sbom---dynamic-sbom-generator-loader">Heimdall SBOM - Dynamic SBOM Generator Loader</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#commands-reference">Commands Reference</a></li>
<li><a href="#supported-formats">Supported Formats</a></li>
<li><a href="#plugin-system">Plugin System</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#advanced-usage">Advanced Usage</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#integration">Integration</a></li>
</ol>
<h2 id="overview">Overview</h2>
<p><code>heimdall-sbom</code> is a dynamic SBOM generator loader that provides a lightweight command-line interface for generating Software Bills of Materials from binary files using Heimdall plugins. It dynamically loads linker plugins and generates SBOMs in multiple formats without requiring the full Heimdall library to be linked.</p>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>Dynamic Plugin Loading</strong>: Loads Heimdall plugins at runtime using <code>dlopen</code>/<code>dlsym</code></li>
<li><strong>Multi-format Support</strong>: SPDX (2.3, 3.0, 3.0.0, 3.0.1) and CycloneDX (1.4, 1.5, 1.6)</li>
<li><strong>Lightweight</strong>: Minimal dependencies, only requires the plugin shared library</li>
<li><strong>Flexible Configuration</strong>: Configurable output formats, versions, and dependency handling</li>
<li><strong>Cross-platform</strong>: Works on Linux and macOS with ELF and Mach-O binaries</li>
<li><strong>Batch Processing</strong>: Process multiple binaries with different configurations</li>
</ul>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li><strong>Standalone SBOM Generation</strong>: Generate SBOMs without full Heimdall installation</li>
<li><strong>CI/CD Integration</strong>: Lightweight SBOM generation in build pipelines</li>
<li><strong>Plugin Testing</strong>: Test Heimdall plugins independently</li>
<li><strong>Binary Analysis</strong>: Analyze existing binaries for SBOM generation</li>
<li><strong>Format Conversion</strong>: Convert between different SBOM formats</li>
</ul>
<h2 id="installation">Installation</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>C++17 or later compiler</li>
<li>CMake 3.15 or later</li>
<li>Git</li>
<li>Dynamic linking support (<code>dlopen</code>/<code>dlsym</code>)</li>
</ul>
<h3 id="building-from-source">Building from Source</h3>
<pre><code class="lang-bash"><span class="hljs-comment"># Clone the repository</span>
git <span class="hljs-built_in">clone</span> https://github.com/Heimdall-SBOM/heimdall.git
<span class="hljs-built_in">cd</span> heimdall

<span class="hljs-comment"># Build the project</span>
mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build
cmake ..
make -j$(nproc)

<span class="hljs-comment"># The heimdall-sbom tool will be available at:</span>
<span class="hljs-comment"># build/heimdall-sbom</span>
</code></pre>
<h3 id="verifying-installation">Verifying Installation</h3>
<pre><code class="lang-bash">./build/heimdall-sbom --<span class="hljs-built_in">help</span>
<span class="hljs-comment"># or</span>
./build/heimdall-sbom
</code></pre>
<h2 id="quick-start">Quick Start</h2>
<h3 id="basic-sbom-generation">Basic SBOM Generation</h3>
<pre><code class="lang-bash"><span class="hljs-comment"># Generate CycloneDX SBOM from a binary</span>
heimdall-sbom /path/to/heimdall-lld.so myapp --format cyclonedx --output myapp.cdx.json

<span class="hljs-comment"># Generate SPDX SBOM from a binary</span>
heimdall-sbom /path/to/heimdall-lld.so myapp --format spdx --output myapp.spdx

<span class="hljs-comment"># Use default format (SPDX 2.3)</span>
heimdall-sbom /path/to/heimdall-lld.so myapp --output myapp.sbom
</code></pre>
<h3 id="using-different-plugin-types">Using Different Plugin Types</h3>
<pre><code class="lang-bash"><span class="hljs-comment"># Use LLD plugin</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp --format cyclonedx-1.6

<span class="hljs-comment"># Use Gold plugin</span>
heimdall-sbom /usr/lib/heimdall/heimdall-gold.so myapp --format spdx-3.0
</code></pre>
<h2 id="commands-reference">Commands Reference</h2>
<h3 id="basic-syntax">Basic Syntax</h3>
<pre><code class="lang-bash">heimdall-sbom &lt;plugin_path&gt; &lt;binary_path&gt; [options]
</code></pre>
<h3 id="required-arguments">Required Arguments</h3>
<ul>
<li><code>&lt;plugin_path&gt;</code> - Path to the Heimdall plugin shared library</li>
<li><code>&lt;binary_path&gt;</code> - Path to the binary file to analyze</li>
</ul>
<h3 id="options">Options</h3>
<h4 id="format-options">Format Options</h4>
<ul>
<li><code>--format &lt;format&gt;</code> - Specify SBOM format<ul>
<li><strong>SPDX formats</strong>: <code>spdx</code>, <code>spdx-2.3</code>, <code>spdx-3.0</code>, <code>spdx-3.0.0</code>, <code>spdx-3.0.1</code></li>
<li><strong>CycloneDX formats</strong>: <code>cyclonedx</code>, <code>cyclonedx-1.4</code>, <code>cyclonedx-1.5</code>, <code>cyclonedx-1.6</code></li>
<li><strong>Default</strong>: <code>spdx-2.3</code></li>
</ul>
</li>
</ul>
<h4 id="output-options">Output Options</h4>
<ul>
<li><code>--output &lt;path&gt;</code> - Output file path (default: <code>sbom.json</code>)</li>
<li><code>--cyclonedx-version &lt;version&gt;</code> - CycloneDX specification version (default: <code>1.6</code>)</li>
<li><code>--spdx-version &lt;version&gt;</code> - SPDX specification version (default: <code>2.3</code>)</li>
</ul>
<h4 id="dependency-options">Dependency Options</h4>
<ul>
<li><code>--no-transitive-dependencies</code> - Include only direct dependencies (default: include all transitive dependencies)</li>
</ul>
<h4 id="examples">Examples</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Basic usage with defaults</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp

<span class="hljs-comment"># Specify format and output</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx-1.6 \
    --output myapp.cdx.json

<span class="hljs-comment"># SPDX with specific version</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format spdx-3.0 \
    --output myapp.spdx

<span class="hljs-comment"># Only direct dependencies</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx \
    --no-transitive-dependencies \
    --output myapp-direct.cdx.json
</code></pre>
<h2 id="supported-formats">Supported Formats</h2>
<h3 id="cyclonedx-support">CycloneDX Support</h3>
<table>
<thead>
<tr>
<th>Version</th>
<th>Status</th>
<th>Features</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.4</td>
<td>✅ Full Support</td>
<td>Basic component structure, metadata</td>
</tr>
<tr>
<td>1.5</td>
<td>✅ Full Support</td>
<td>Enhanced validation, additional fields</td>
</tr>
<tr>
<td>1.6</td>
<td>✅ Full Support</td>
<td>Latest features, complete validation</td>
</tr>
</tbody>
</table>
<p><strong>Generated Fields:</strong></p>
<ul>
<li><code>bomFormat</code>, <code>specVersion</code>, <code>version</code>, <code>metadata</code></li>
<li>Component information (name, version, type, purl)</li>
<li>Dependencies and relationships</li>
<li>File hashes and integrity information</li>
<li>License information</li>
<li>Supplier and author details</li>
</ul>
<h3 id="spdx-support">SPDX Support</h3>
<table>
<thead>
<tr>
<th>Version</th>
<th>Status</th>
<th>Format</th>
<th>Features</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.3</td>
<td>✅ Full Support</td>
<td>Tag-value</td>
<td>Complete validation</td>
</tr>
<tr>
<td>3.0</td>
<td>✅ Full Support</td>
<td>JSON</td>
<td>Complete validation</td>
</tr>
<tr>
<td>3.0.0</td>
<td>✅ Full Support</td>
<td>JSON</td>
<td>Complete validation</td>
</tr>
<tr>
<td>3.0.1</td>
<td>✅ Full Support</td>
<td>JSON</td>
<td>Complete validation</td>
</tr>
</tbody>
</table>
<p><strong>Generated Fields:</strong></p>
<ul>
<li><code>SPDXVersion</code>, <code>DataLicense</code>, <code>DocumentName</code></li>
<li>Package and file information</li>
<li>License expressions and identifiers</li>
<li>Checksums and integrity information</li>
<li>Relationships between components</li>
<li>Creator and creation information</li>
</ul>
<h2 id="plugin-system">Plugin System</h2>
<h3 id="plugin-architecture">Plugin Architecture</h3>
<p><code>heimdall-sbom</code> uses dynamic loading to interface with Heimdall plugins:</p>
<p><img src="images/mermaid/heimdall-sbom-manual_diagram_1.png" alt="Mermaid Diagram"></img></p>
<h3 id="required-plugin-functions">Required Plugin Functions</h3>
<p>The tool expects the following functions to be exported by the plugin:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// Plugin initialization</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">onload</span><span class="hljs-params">(<span class="hljs-keyword">void</span>* context)</span></span>;

<span class="hljs-comment">// Format configuration</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_format</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* format)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_cyclonedx_version</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* version)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_spdx_version</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* version)</span></span>;

<span class="hljs-comment">// Output configuration</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_output_path</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* path)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_transitive_dependencies</span><span class="hljs-params">(<span class="hljs-keyword">int</span> enabled)</span></span>;

<span class="hljs-comment">// Processing</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_process_input_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* path)</span></span>;

<span class="hljs-comment">// Cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heimdall_finalize</span><span class="hljs-params">()</span></span>;
</code></pre>
<h3 id="plugin-loading-process">Plugin Loading Process</h3>
<ol>
<li><strong>Library Loading</strong>: Uses <code>dlopen()</code> to load the plugin shared library</li>
<li><strong>Symbol Resolution</strong>: Uses <code>dlsym()</code> to resolve required function symbols</li>
<li><strong>Initialization</strong>: Calls <code>onload()</code> to initialize the plugin</li>
<li><strong>Configuration</strong>: Sets format, version, and output parameters</li>
<li><strong>Processing</strong>: Calls <code>process_input_file()</code> to analyze the binary</li>
<li><strong>Finalization</strong>: Calls <code>finalize()</code> to generate the SBOM</li>
<li><strong>Cleanup</strong>: Unloads the plugin library</li>
</ol>
<h2 id="examples">Examples</h2>
<h3 id="basic-examples">Basic Examples</h3>
<h4 id="generate-cyclonedx-16-sbom">Generate CycloneDX 1.6 SBOM</h4>
<pre><code class="lang-bash">heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx-1.6 \
    --output myapp.cdx.json
</code></pre>
<p><strong>Expected Output:</strong></p>
<pre><code>Processing myapp with heimdall-lld.so...
SBOM generated successfully: myapp.cdx.json
</code></pre><h4 id="generate-spdx-30-json-sbom">Generate SPDX 3.0 JSON SBOM</h4>
<pre><code class="lang-bash">heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format spdx-3.0 \
    --output myapp.spdx.json
</code></pre>
<h4 id="generate-spdx-23-tag-value-sbom">Generate SPDX 2.3 Tag-Value SBOM</h4>
<pre><code class="lang-bash">heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format spdx-2.3 \
    --output myapp.spdx
</code></pre>
<h3 id="advanced-examples">Advanced Examples</h3>
<h4 id="process-multiple-binaries">Process Multiple Binaries</h4>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># process-binaries.sh</span>

PLUGIN=<span class="hljs-string">"/usr/lib/heimdall/heimdall-lld.so"</span>
FORMAT=<span class="hljs-string">"cyclonedx-1.6"</span>

<span class="hljs-keyword">for</span> binary <span class="hljs-keyword">in</span> *.exe *.bin; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$binary</span>"</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"Processing <span class="hljs-variable">$binary</span>..."</span>
        heimdall-sbom <span class="hljs-string">"<span class="hljs-variable">$PLUGIN</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$binary</span>"</span> \
            --format <span class="hljs-string">"<span class="hljs-variable">$FORMAT</span>"</span> \
            --output <span class="hljs-string">"<span class="hljs-variable">${binary%.*}</span>.cdx.json"</span>
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h4 id="batch-processing-with-different-formats">Batch Processing with Different Formats</h4>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># batch-sbom.sh</span>

PLUGIN=<span class="hljs-string">"/usr/lib/heimdall/heimdall-lld.so"</span>
BINARY=<span class="hljs-string">"myapp"</span>

<span class="hljs-comment"># Generate multiple formats</span>
heimdall-sbom <span class="hljs-string">"<span class="hljs-variable">$PLUGIN</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>"</span> --format cyclonedx-1.6 --output <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>.cdx.json"</span>
heimdall-sbom <span class="hljs-string">"<span class="hljs-variable">$PLUGIN</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>"</span> --format spdx-3.0 --output <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>.spdx.json"</span>
heimdall-sbom <span class="hljs-string">"<span class="hljs-variable">$PLUGIN</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>"</span> --format spdx-2.3 --output <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>.spdx"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Generated SBOMs:"</span>
ls -la <span class="hljs-string">"<span class="hljs-variable">$BINARY</span>"</span>.*
</code></pre>
<h4 id="compare-direct-vs-transitive-dependencies">Compare Direct vs Transitive Dependencies</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Generate SBOM with all dependencies</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx-1.6 \
    --output myapp-all.cdx.json

<span class="hljs-comment"># Generate SBOM with only direct dependencies</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx-1.6 \
    --no-transitive-dependencies \
    --output myapp-direct.cdx.json

<span class="hljs-comment"># Compare the results</span>
diff myapp-all.cdx.json myapp-direct.cdx.json
</code></pre>
<h2 id="advanced-usage">Advanced Usage</h2>
<h3 id="plugin-development">Plugin Development</h3>
<h4 id="creating-a-custom-plugin">Creating a Custom Plugin</h4>
<pre><code class="lang-cpp"><span class="hljs-comment">// my_plugin.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">onload</span><span class="hljs-params">(<span class="hljs-keyword">void</span>* context)</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"My plugin loaded successfully"</span> &lt;&lt; std::endl;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_format</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* format)</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"Setting format: "</span> &lt;&lt; format &lt;&lt; std::endl;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_set_output_path</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* path)</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"Setting output path: "</span> &lt;&lt; path &lt;&lt; std::endl;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">heimdall_process_input_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* path)</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"Processing file: "</span> &lt;&lt; path &lt;&lt; std::endl;
        <span class="hljs-comment">// Your SBOM generation logic here</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heimdall_finalize</span><span class="hljs-params">()</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"Finalizing SBOM generation"</span> &lt;&lt; std::endl;
    }
}
</code></pre>
<h4 id="building-the-plugin">Building the Plugin</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Compile the plugin</span>
g++ -shared -fPIC my_plugin.cpp -o my_plugin.so

<span class="hljs-comment"># Use with heimdall-sbom</span>
heimdall-sbom ./my_plugin.so myapp --format cyclonedx --output myapp.cdx.json
</code></pre>
<h3 id="integration-with-build-systems">Integration with Build Systems</h3>
<h4 id="cmake-integration">CMake Integration</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># CMakeLists.txt</span>
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)

<span class="hljs-keyword">add_executable</span>(myapp main.cpp)
<span class="hljs-keyword">target_link_libraries</span>(myapp <span class="hljs-variable">${HEIMDALL_LIBRARIES}</span>)

<span class="hljs-comment"># Custom target for SBOM generation</span>
<span class="hljs-keyword">add_custom_target</span>(sbom
    <span class="hljs-keyword">COMMAND</span> heimdall-sbom
        <span class="hljs-variable">${HEIMDALL_PLUGIN_PATH}</span>/heimdall-lld.so
        $&lt;TARGET_FILE:myapp&gt;
        --format cyclonedx-<span class="hljs-number">1.6</span>
        --output <span class="hljs-variable">${CMAKE_BINARY_DIR}</span>/myapp.cdx.json
    DEPENDS myapp
    COMMENT <span class="hljs-string">"Generating SBOM for myapp"</span>
)
</code></pre>
<h4 id="makefile-integration">Makefile Integration</h4>
<pre><code class="lang-makefile"><span class="hljs-comment"># Makefile</span>
HEIMDALL_PLUGIN = /usr/lib/heimdall/heimdall-lld.so
SBOM_FORMAT = cyclonedx-1.6

<span class="hljs-section">myapp: main.cpp</span>
    g++ -o myapp main.cpp

<span class="hljs-section">sbom: myapp</span>
    heimdall-sbom <span class="hljs-variable">$(HEIMDALL_PLUGIN)</span> myapp \
        --format <span class="hljs-variable">$(SBOM_FORMAT)</span> \
        --output myapp.cdx.json

<span class="hljs-meta"><span class="hljs-meta-keyword">.PHONY</span>: sbom</span>
</code></pre>
<h3 id="cicd-integration">CI/CD Integration</h3>
<h4 id="github-actions">GitHub Actions</h4>
<pre><code class="lang-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">SBOM</span>
<span class="hljs-attr">on:</span> [<span class="hljs-string">push</span>, <span class="hljs-string">pull_request</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">sbom:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">Application</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          g++ -o myapp main.cpp
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Heimdall</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          git clone https://github.com/Heimdall-SBOM/heimdall.git
          cd heimdall
          mkdir build &amp;&amp; cd build
          cmake ..
          make -j$(nproc)
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">SBOM</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          ./heimdall/build/heimdall-sbom \
            ./heimdall/build/lib/heimdall-lld.so \
            myapp \
            --format cyclonedx-1.6 \
            --output myapp.cdx.json
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">SBOM</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">sbom</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">myapp.cdx.json</span>
</code></pre>
<h4 id="jenkins-pipeline">Jenkins Pipeline</h4>
<pre><code class="lang-groovy">pipeline {
    agent any

    stages {
        stage(<span class="hljs-string">'Build'</span>) {
            steps {
                sh <span class="hljs-string">'g++ -o myapp main.cpp'</span>
            }
        }

        stage(<span class="hljs-string">'Generate SBOM'</span>) {
            steps {
                sh <span class="hljs-string">'''
                    git clone https://github.com/Heimdall-SBOM/heimdall.git
                    cd heimdall
                    mkdir build &amp;&amp; cd build
                    cmake ..
                    make -j$(nproc)

                    ../../heimdall-sbom \
                        ./lib/heimdall-lld.so \
                        ../../myapp \
                        --format cyclonedx-1.6 \
                        --output ../../myapp.cdx.json
                '''</span>
            }
        }

        stage(<span class="hljs-string">'Archive SBOM'</span>) {
            steps {
                archiveArtifacts <span class="hljs-attr">artifacts:</span> <span class="hljs-string">'myapp.cdx.json'</span>
            }
        }
    }
}
</code></pre>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="1-failed-to-load-plugin">1. "Failed to load plugin"</h4>
<p><strong>Cause:</strong> Plugin file doesn't exist or has incorrect permissions
<strong>Solution:</strong> Check plugin path and permissions</p>
<pre><code class="lang-bash">ls -la /usr/lib/heimdall/heimdall-lld.so
chmod 755 /usr/lib/heimdall/heimdall-lld.so
</code></pre>
<h4 id="2-failed-to-get-function-symbols">2. "Failed to get function symbols"</h4>
<p><strong>Cause:</strong> Plugin doesn't export required functions
<strong>Solution:</strong> Ensure plugin implements all required functions</p>
<pre><code class="lang-bash">nm -D /usr/lib/heimdall/heimdall-lld.so | grep heimdall
</code></pre>
<h4 id="3-failed-to-initialize-plugin">3. "Failed to initialize plugin"</h4>
<p><strong>Cause:</strong> Plugin initialization failed
<strong>Solution:</strong> Check plugin logs and dependencies</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Check plugin dependencies</span>
ldd /usr/lib/heimdall/heimdall-lld.so
</code></pre>
<h4 id="4-failed-to-process-binary">4. "Failed to process binary"</h4>
<p><strong>Cause:</strong> Binary file doesn't exist or is not supported
<strong>Solution:</strong> Verify binary path and format</p>
<pre><code class="lang-bash">file myapp
ls -la myapp
</code></pre>
<h3 id="debug-mode">Debug Mode</h3>
<p>Enable verbose output for debugging:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Set environment variable for verbose output</span>
<span class="hljs-built_in">export</span> HEIMDALL_VERBOSE=1
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp --format cyclonedx
</code></pre>
<h3 id="error-codes">Error Codes</h3>
<table>
<thead>
<tr>
<th>Exit Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Success</td>
</tr>
<tr>
<td>1</td>
<td>Plugin loading failed</td>
</tr>
<tr>
<td>2</td>
<td>Plugin initialization failed</td>
</tr>
<tr>
<td>3</td>
<td>Binary processing failed</td>
</tr>
<tr>
<td>4</td>
<td>Invalid command line arguments</td>
</tr>
</tbody>
</table>
<h3 id="performance-tips">Performance Tips</h3>
<ol>
<li><strong>Use absolute paths</strong> for plugins and binaries to avoid path resolution issues</li>
<li><strong>Pre-load plugins</strong> in long-running processes to avoid repeated loading overhead</li>
<li><strong>Use appropriate formats</strong> for your use case (JSON for programmatic processing, tag-value for human reading)</li>
<li><strong>Consider dependency scope</strong> - use <code>--no-transitive-dependencies</code> for faster processing when only direct dependencies are needed</li>
</ol>
<h2 id="integration">Integration</h2>
<h3 id="with-other-tools">With Other Tools</h3>
<h4 id="integration-with-cyclonedx-tools">Integration with CycloneDX Tools</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Generate SBOM with heimdall-sbom</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format cyclonedx-1.6 \
    --output myapp.cdx.json

<span class="hljs-comment"># Validate with cyclonedx-cli</span>
cyclonedx-cli validate myapp.cdx.json

<span class="hljs-comment"># Convert to other formats</span>
cyclonedx-cli convert --input-format json --output-format xml myapp.cdx.json
</code></pre>
<h4 id="integration-with-spdx-tools">Integration with SPDX Tools</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Generate SPDX SBOM</span>
heimdall-sbom /usr/lib/heimdall/heimdall-lld.so myapp \
    --format spdx-3.0 \
    --output myapp.spdx.json

<span class="hljs-comment"># Validate with SPDX tools</span>
spdx-tools-validate myapp.spdx.json
</code></pre>
<h3 id="api-integration">API Integration</h3>
<p>The tool can be integrated into custom scripts and applications:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> subprocess
<span class="hljs-keyword">import</span> json

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sbom</span>(<span class="hljs-params">plugin_path, binary_path, <span class="hljs-built_in">format</span>=<span class="hljs-string">'cyclonedx-1.6'</span>, output_path=<span class="hljs-string">'sbom.json'</span></span>):</span>
    cmd = [
        <span class="hljs-string">'heimdall-sbom'</span>,
        plugin_path,
        binary_path,
        <span class="hljs-string">'--format'</span>, <span class="hljs-built_in">format</span>,
        <span class="hljs-string">'--output'</span>, output_path
    ]

    result = subprocess.run(cmd, capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">return</span> result.returncode == <span class="hljs-number">0</span>, result.stdout, result.stderr

<span class="hljs-comment"># Usage</span>
success, output, errors = generate_sbom(
    <span class="hljs-string">'/usr/lib/heimdall/heimdall-lld.so'</span>,
    <span class="hljs-string">'myapp'</span>,
    <span class="hljs-string">'cyclonedx-1.6'</span>,
    <span class="hljs-string">'myapp.cdx.json'</span>
)

<span class="hljs-keyword">if</span> success:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"SBOM generated successfully"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Error: <span class="hljs-subst">{errors}</span>"</span>)
</code></pre>
<h3 id="configuration-files">Configuration Files</h3>
<p>Create configuration files for repeated operations:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"defaults"</span>: {
    <span class="hljs-string">"plugin_path"</span>: <span class="hljs-string">"/usr/lib/heimdall/heimdall-lld.so"</span>,
    <span class="hljs-string">"format"</span>: <span class="hljs-string">"cyclonedx-1.6"</span>,
    <span class="hljs-string">"include_transitive"</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-string">"formats"</span>: {
    <span class="hljs-string">"cyclonedx"</span>: {
      <span class="hljs-string">"versions"</span>: [<span class="hljs-string">"1.4"</span>, <span class="hljs-string">"1.5"</span>, <span class="hljs-string">"1.6"</span>],
      <span class="hljs-string">"default"</span>: <span class="hljs-string">"1.6"</span>
    },
    <span class="hljs-string">"spdx"</span>: {
      <span class="hljs-string">"versions"</span>: [<span class="hljs-string">"2.3"</span>, <span class="hljs-string">"3.0"</span>, <span class="hljs-string">"3.0.0"</span>, <span class="hljs-string">"3.0.1"</span>],
      <span class="hljs-string">"default"</span>: <span class="hljs-string">"2.3"</span>
    }
  },
  <span class="hljs-string">"output"</span>: {
    <span class="hljs-string">"directory"</span>: <span class="hljs-string">"./sboms"</span>,
    <span class="hljs-string">"naming"</span>: <span class="hljs-string">"{binary}.{format}.{version}.json"</span>
  }
}
</code></pre>
<h3 id="shell-scripts">Shell Scripts</h3>
<h4 id="automated-sbom-generation-script">Automated SBOM Generation Script</h4>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># generate-sboms.sh</span>

PLUGIN_PATH=<span class="hljs-string">"<span class="hljs-variable">${HEIMDALL_PLUGIN:-/usr/lib/heimdall/heimdall-lld.so}</span>"</span>
OUTPUT_DIR=<span class="hljs-string">"<span class="hljs-variable">${SBOM_OUTPUT_DIR:-./sboms}</span>"</span>
FORMATS=(<span class="hljs-string">"cyclonedx-1.6"</span> <span class="hljs-string">"spdx-3.0"</span> <span class="hljs-string">"spdx-2.3"</span>)

<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -eq 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: <span class="hljs-variable">$0</span> &lt;binary1&gt; [binary2] ..."</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

mkdir -p <span class="hljs-string">"<span class="hljs-variable">$OUTPUT_DIR</span>"</span>

<span class="hljs-keyword">for</span> binary <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">$@</span>"</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">$binary</span>"</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"Warning: <span class="hljs-variable">$binary</span> not found, skipping"</span>
        <span class="hljs-built_in">continue</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Processing <span class="hljs-variable">$binary</span>..."</span>

    <span class="hljs-keyword">for</span> format <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${FORMATS[@]}</span>"</span>; <span class="hljs-keyword">do</span>
        output_file=<span class="hljs-string">"<span class="hljs-variable">$OUTPUT_DIR</span>/<span class="hljs-subst">$(basename <span class="hljs-string">"<span class="hljs-variable">$binary</span>"</span>)</span>.<span class="hljs-variable">${format//-/.}</span>.json"</span>

        <span class="hljs-built_in">echo</span> <span class="hljs-string">"  Generating <span class="hljs-variable">$format</span> SBOM..."</span>
        <span class="hljs-keyword">if</span> heimdall-sbom <span class="hljs-string">"<span class="hljs-variable">$PLUGIN_PATH</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$binary</span>"</span> \
            --format <span class="hljs-string">"<span class="hljs-variable">$format</span>"</span> \
            --output <span class="hljs-string">"<span class="hljs-variable">$output_file</span>"</span>; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"    ✅ Generated: <span class="hljs-variable">$output_file</span>"</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"    ❌ Failed to generate: <span class="hljs-variable">$output_file</span>"</span>
        <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">done</span>
<span class="hljs-keyword">done</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"SBOM generation complete. Files saved to: <span class="hljs-variable">$OUTPUT_DIR</span>"</span>
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p><code>heimdall-sbom</code> provides a lightweight, flexible interface for generating SBOMs from binary files using Heimdall plugins. Its dynamic loading approach makes it ideal for integration into existing toolchains and CI/CD pipelines without requiring full Heimdall installation.</p>
<p>For more information, see:</p>
<ul>
<li><a href="heimdall-users-guide.md">Heimdall User Guide</a></li>
<li><a href="heimdall-validate-manual.html">Heimdall Validate Manual</a></li>
<li><a href="heimdall-developers-guide.md">Plugin Development Guide</a></li>
<li><a href="https://cyclonedx.org/specification/" target="_blank">CycloneDX Specification</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="cmake_module.html" class="navigation navigation-prev " aria-label="Previous page: CMake Module">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="heimdall-validate-manual.html" class="navigation navigation-next " aria-label="Next page: Heimdall Validate Manual">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Heimdall SBOM Manual","level":"1.4","depth":1,"next":{"title":"Heimdall Validate Manual","level":"1.5","depth":1,"path":"docs/heimdall-validate-manual.md","ref":"docs/heimdall-validate-manual.md","articles":[]},"previous":{"title":"CMake Module","level":"1.3","depth":1,"path":"docs/cmake_module.md","ref":"docs/cmake_module.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"docs/heimdall-sbom-manual.md","mtime":"2025-07-27T21:36:11.033Z","type":"markdown"},"gitbook":{"version":"4.0.8","time":"2025-07-27T21:36:16.340Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

