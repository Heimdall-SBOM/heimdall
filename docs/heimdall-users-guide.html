<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>heimdall-users-guide</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Note:</strong> To generate HTML and PDF versions of this guide, install <a href="https://pandoc.org/">pandoc</a> and <a href="https://www.tug.org/texlive/">pdflatex</a> (from TeX Live):</td>
</tr>
<tr class="even">
<td><code>sh sudo dnf install -y pandoc texlive</code></td>
</tr>
<tr class="odd">
<td>Then use the CMake targets <code>docs-html</code> and <code>docs-pdf</code>.</td>
</tr>
</tbody>
</table>
<h1 id="heimdall-sbom-generator---user-guide">Heimdall SBOM Generator - User Guide</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#advanced-features">Advanced Features</a></li>
<li><a href="#sbom-formats-and-versions">SBOM Formats and Versions</a></li>
<li><a href="#dwarf-debug-information">DWARF Debug Information</a></li>
<li><a href="#sbom-validation-and-tools">SBOM Validation and Tools</a></li>
<li><a href="#build-system-integration">Build System Integration</a></li>
<li><a href="#command-line-integration">Command-Line Integration</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>Heimdall is a comprehensive Software Bill of Materials (SBOM) generation plugin that works seamlessly with both LLVM LLD and GNU Gold linkers. It automatically generates accurate SBOMs during the linking process, capturing all components that actually make it into your final binaries, including comprehensive DWARF debug information.</p>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>Dual Linker Support</strong>: Works with both LLVM LLD and GNU Gold linkers</li>
<li><strong>Multiple SBOM Formats</strong>: SPDX 2.3/3.0 and CycloneDX 1.4-1.6 with version selection</li>
<li><strong>Enhanced DWARF Integration</strong>: Extracts source files, functions, and compile units</li>
<li><strong>Comprehensive Validation</strong>: Built-in validation tools for standards compliance</li>
<li><strong>Cross-Platform</strong>: Native support for macOS and Linux</li>
<li><strong>Performance Optimized</strong>: Minimal overhead during linking</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>C++11 compatible compiler (GCC 4.8+ or Clang 3.3+ recommended)</li>
<li>C++14, C++17, or C++23 compatible compiler for enhanced features</li>
<li>CMake 3.16+</li>
<li>OpenSSL development libraries</li>
<li>LLVM 19 (for DWARF support)</li>
<li>libelf (for ELF parsing)</li>
<li>BFD (for Gold plugin)</li>
</ul>
<h3 id="quick-installation">Quick Installation</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/heimdall-sbom/heimdall.git</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> heimdall</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span></span></code></pre></div>
<h3 id="c-standard-support">C++ Standard Support</h3>
<p>Heimdall supports C++11, C++14, C++17, and C++23 standards:</p>
<p><strong>C++11 (Minimum):</strong> - Basic functionality - Uses <code>.find() != std::string::npos</code> for string operations - Compatible with older compilers</p>
<p><strong>C++14/17/23 (Enhanced features):</strong> - Uses modern features like <code>std::string::contains()</code> (C++23) - <code>starts_with</code>, <code>ends_with</code> (C++20+) - Future support for <code>std::format</code>, <code>std::print</code>, and more</p>
<h3 id="building-with-different-standards">Building with Different Standards</h3>
<p>You can build Heimdall with any supported C++ standard:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Default (C++23)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-B</span> build <span class="at">-DHEIMDALL_CPP_STANDARD</span><span class="op">=</span>23</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># C++17</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-B</span> build_cpp17 <span class="at">-DHEIMDALL_CPP_STANDARD</span><span class="op">=</span>17</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build_cpp17</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># C++14</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-B</span> build_cpp14 <span class="at">-DHEIMDALL_CPP_STANDARD</span><span class="op">=</span>14</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build_cpp14</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># C++11</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-B</span> build_cpp11 <span class="at">-DHEIMDALL_CPP_STANDARD</span><span class="op">=</span>11</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build_cpp11</span></code></pre></div>
<h2 id="installation">Installation</h2>
<h3 id="macos-setup">macOS Setup</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install LLVM/LLD and other dependencies</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install llvm cmake ninja openssl</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span><span class="st">&quot;/opt/homebrew/opt/llvm/bin:</span><span class="va">$PATH</span><span class="st">&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Heimdall (LLD plugin only)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span></span></code></pre></div>
<h3 id="linux-setup">Linux Setup</h3>
<h4 id="ubuntudebian">Ubuntu/Debian</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install all dependencies including Gold linker</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    build-essential <span class="dt">\</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    cmake <span class="dt">\</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ninja-build <span class="dt">\</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    binutils <span class="dt">\</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    binutils-dev <span class="dt">\</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    libssl-dev <span class="dt">\</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    libelf-dev <span class="dt">\</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    libgtest-dev <span class="dt">\</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    pkg-config</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Install LLVM 19 (recommended for full DWARF support)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-O</span> <span class="at">-</span> https://apt.llvm.org/llvm-snapshot.gpg.key <span class="kw">|</span> <span class="fu">sudo</span> apt-key add <span class="at">-</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;deb http://apt.llvm.org/jammy/ llvm-toolchain-jammy-19 main&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee /etc/apt/sources.list.d/llvm.list</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install <span class="at">-y</span> llvm-19-dev liblld-19-dev</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Heimdall with both LLD and Gold plugins</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span></span></code></pre></div>
<h4 id="fedorarhelcentos">Fedora/RHEL/CentOS</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> yum install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    gcc-c++ <span class="dt">\</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    cmake <span class="dt">\</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    ninja-build <span class="dt">\</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    llvm-devel <span class="dt">\</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    lld-devel <span class="dt">\</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    binutils-gold <span class="dt">\</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    openssl-devel <span class="dt">\</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    pkgconfig <span class="dt">\</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    zlib-devel <span class="dt">\</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    llvm-googletest <span class="dt">\</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    binutils-devel</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span></span></code></pre></div>
<h3 id="build-options">Build Options</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Debug build with sanitizers</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span> <span class="at">--debug</span> <span class="at">--sanitizers</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build only LLD plugin (macOS default)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span> <span class="at">--no-gold</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Build only Gold plugin (Linux only)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span> <span class="at">--no-lld</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom build directory</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ex">./build.sh</span> <span class="at">--build-dir</span> mybuild <span class="at">--install-dir</span> myinstall</span></code></pre></div>
<h2 id="basic-usage">Basic Usage</h2>
<h3 id="simple-c-program">Simple C Program</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile with debug information for DWARF extraction</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-g</span> <span class="at">-c</span> main.c <span class="at">-o</span> main.o</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using LLD with CycloneDX 1.6 (default)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:myapp.cyclonedx.json <span class="dt">\</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>format:cyclonedx <span class="dt">\</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> myapp</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Using LLD with SPDX 3.0 JSON (default)</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:myapp.spdx.json <span class="dt">\</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>format:spdx <span class="dt">\</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> myapp</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Gold (Linux only)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.gold</span> <span class="at">--plugin</span> ./heimdall-gold.so <span class="dt">\</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">--plugin-opt</span> sbom-output=myapp.cyclonedx.json <span class="dt">\</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">--plugin-opt</span> format=cyclonedx <span class="dt">\</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        main.o <span class="at">-o</span> myapp</span></code></pre></div>
<h3 id="plugin-options">Plugin Options</h3>
<h4 id="lld-plugin-options">LLD Plugin Options</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=load:./heimdall-lld.dylib</span>          <span class="co"># Load the plugin</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=sbom-output:output.json</span>             <span class="co"># Output file path</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=format:cyclonedx</span>                    <span class="co"># Format (cyclonedx, spdx)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.6</span>               <span class="co"># CycloneDX version (1.4, 1.5, 1.6)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=spdx-version:3.0</span>                    <span class="co"># SPDX version (2.3, 3.0)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=verbose</span>                             <span class="co"># Enable verbose output</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=no-debug-info</span>                       <span class="co"># Disable DWARF extraction</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=include-system-libs</span>                 <span class="co"># Include system libraries</span></span></code></pre></div>
<h4 id="gold-plugin-options-linux-only">Gold Plugin Options (Linux only)</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin</span> ./heimdall-gold.so                      <span class="co"># Load the plugin</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> sbom-output=output.json             <span class="co"># Output file path</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> format=cyclonedx                    <span class="co"># Format (cyclonedx, spdx)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> cyclonedx-version=1.6               <span class="co"># CycloneDX version (1.4, 1.5, 1.6)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> spdx-version=3.0                    <span class="co"># SPDX version (2.3, 3.0)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> verbose                             <span class="co"># Enable verbose output</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> no-debug-info                       <span class="co"># Disable DWARF extraction</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt</span> include-system-libs                 <span class="co"># Include system libraries</span></span></code></pre></div>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="version-selection">Version Selection</h3>
<p>Heimdall supports multiple versions of both SPDX and CycloneDX standards:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CycloneDX versions</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.4</span>               <span class="co"># CycloneDX 1.4</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.5</span>               <span class="co"># CycloneDX 1.5</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.6</span>               <span class="co"># CycloneDX 1.6 (default)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># SPDX versions</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=spdx-version:2.3</span>                    <span class="co"># SPDX 2.3 tag-value</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=spdx-version:3.0</span>                    <span class="co"># SPDX 3.0 JSON (default)</span></span></code></pre></div>
<h3 id="verbose-output">Verbose Output</h3>
<p>Enable detailed processing information:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:debug-sbom.json <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>verbose <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> debug-app</span></code></pre></div>
<h3 id="system-library-inclusion">System Library Inclusion</h3>
<p>Include system libraries in the SBOM:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:full-sbom.json <span class="dt">\</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>include-system-libs <span class="dt">\</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> full-app</span></code></pre></div>
<h2 id="sbom-formats-and-versions">SBOM Formats and Versions</h2>
<h3 id="cyclonedx-1.4-1.6">CycloneDX 1.4-1.6</h3>
<p>CycloneDX is a lightweight SBOM standard designed for application security contexts and supply chain component analysis.</p>
<h4 id="features-by-version">Features by Version</h4>
<p><strong>CycloneDX 1.4:</strong> - Basic component metadata - Dependencies and relationships - License information - Hash information</p>
<p><strong>CycloneDX 1.5:</strong> - Enhanced metadata - External references - PURL identifiers - Improved relationships</p>
<p><strong>CycloneDX 1.6 (Default):</strong> - Lifecycle information - Evidence collection - Enhanced properties - Extended metadata</p>
<h4 id="example-cyclonedx-output">Example CycloneDX Output</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;bomFormat&quot;</span><span class="fu">:</span> <span class="st">&quot;CycloneDX&quot;</span><span class="fu">,</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;specVersion&quot;</span><span class="fu">:</span> <span class="st">&quot;1.6&quot;</span><span class="fu">,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;metadata&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;timestamp&quot;</span><span class="fu">:</span> <span class="st">&quot;2024-01-15T10:30:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;tools&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;vendor&quot;</span><span class="fu">:</span> <span class="st">&quot;Heimdall&quot;</span><span class="fu">,</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;SBOM Generator&quot;</span><span class="fu">,</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0.0&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;components&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;application&quot;</span><span class="fu">,</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;myapp&quot;</span><span class="fu">,</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0.0&quot;</span><span class="fu">,</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;purl&quot;</span><span class="fu">:</span> <span class="st">&quot;pkg:generic/myapp@1.0.0&quot;</span><span class="fu">,</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;heimdall:source-files&quot;</span><span class="fu">,</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;main.c,utils.c&quot;</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;heimdall:functions&quot;</span><span class="fu">,</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;main,calculate,process_data&quot;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;heimdall:contains-debug-info&quot;</span><span class="fu">,</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;true&quot;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="spdx-2.3-and-3.0">SPDX 2.3 and 3.0</h3>
<p>SPDX is a comprehensive standard for communicating software bill of materials information.</p>
<h4 id="features-by-version-1">Features by Version</h4>
<p><strong>SPDX 2.3:</strong> - Tag-value format - Package and file information - License information - Relationships</p>
<p><strong>SPDX 3.0 (Default):</strong> - JSON format - Enhanced relationships - Extended metadata - Improved structure</p>
<h4 id="example-spdx-output">Example SPDX Output</h4>
<p><strong>SPDX 2.3 (Tag-Value):</strong></p>
<pre><code>SPDXVersion: SPDX-2.3
DataLicense: CC0-1.0
SPDXID: SPDXRef-DOCUMENT
DocumentName: myapp-sbom
DocumentNamespace: https://example.com/myapp-sbom
Creator: Tool: Heimdall-SBOM-Generator-1.0.0
Created: 2024-01-15T10:30:00Z

PackageName: myapp
SPDXID: SPDXRef-myapp
PackageVersion: 1.0.0
PackageDownloadLocation: NOASSERTION
FilesAnalyzed: true
PackageLicenseConcluded: MIT
PackageLicenseDeclared: MIT

FileName: main.c
SPDXID: SPDXRef-main.c
FileChecksum: SHA256: abc123...
LicenseConcluded: MIT

Relationship: SPDXRef-myapp GENERATED_FROM SPDXRef-main.c</code></pre>
<p><strong>SPDX 3.0 (JSON):</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;spdxVersion&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDX-3.0&quot;</span><span class="fu">,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dataLicense&quot;</span><span class="fu">:</span> <span class="st">&quot;CC0-1.0&quot;</span><span class="fu">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;SPDXID&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDXRef-DOCUMENT&quot;</span><span class="fu">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;myapp-sbom&quot;</span><span class="fu">,</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;documentNamespace&quot;</span><span class="fu">:</span> <span class="st">&quot;https://example.com/myapp-sbom&quot;</span><span class="fu">,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;creationInfo&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;creators&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Tool: Heimdall-SBOM-Generator-1.0.0&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;created&quot;</span><span class="fu">:</span> <span class="st">&quot;2024-01-15T10:30:00Z&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;packages&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;SPDXID&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDXRef-myapp&quot;</span><span class="fu">,</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;myapp&quot;</span><span class="fu">,</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;versionInfo&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0.0&quot;</span><span class="fu">,</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;downloadLocation&quot;</span><span class="fu">:</span> <span class="st">&quot;NOASSERTION&quot;</span><span class="fu">,</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;licenseConcluded&quot;</span><span class="fu">:</span> <span class="st">&quot;MIT&quot;</span><span class="fu">,</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;licenseDeclared&quot;</span><span class="fu">:</span> <span class="st">&quot;MIT&quot;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;files&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;SPDXID&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDXRef-main.c&quot;</span><span class="fu">,</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;fileName&quot;</span><span class="fu">:</span> <span class="st">&quot;main.c&quot;</span><span class="fu">,</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;checksums&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;algorithm&quot;</span><span class="fu">:</span> <span class="st">&quot;SHA256&quot;</span><span class="fu">,</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;checksumValue&quot;</span><span class="fu">:</span> <span class="st">&quot;abc123...&quot;</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;licenseConcluded&quot;</span><span class="fu">:</span> <span class="st">&quot;MIT&quot;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;relationships&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;spdxElementId&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDXRef-myapp&quot;</span><span class="fu">,</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;relatedSpdxElement&quot;</span><span class="fu">:</span> <span class="st">&quot;SPDXRef-main.c&quot;</span><span class="fu">,</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;relationshipType&quot;</span><span class="fu">:</span> <span class="st">&quot;GENERATED_FROM&quot;</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h2 id="dwarf-debug-information">DWARF Debug Information</h2>
<p>Heimdall provides comprehensive DWARF debug information integration that enhances your SBOMs with detailed source code traceability.</p>
<h3 id="source-file-tracking">Source File Tracking</h3>
<p>Heimdall automatically extracts source file paths from DWARF debug info and includes them as separate SBOM components:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile with debug information</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-g</span> <span class="at">-c</span> main.c utils.c <span class="at">-o</span> main.o</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate SBOM with source files</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:with-sources.json <span class="dt">\</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>format:cyclonedx <span class="dt">\</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> myapp</span></code></pre></div>
<h3 id="function-level-analysis">Function-Level Analysis</h3>
<p>Heimdall extracts function names and includes them in SBOM properties:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;heimdall:functions&quot;</span><span class="fu">,</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;main,calculate,process_data,validate_input&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="compile-unit-information">Compile Unit Information</h3>
<p>Compile unit information is extracted for build system integration:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;heimdall:compile-units&quot;</span><span class="fu">,</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;main.c,utils.c&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="fallback-extraction">Fallback Extraction</h3>
<p>When DWARF parsing fails, Heimdall uses ELF symbol table fallback:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Even without DWARF, functions are extracted from symbols</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-c</span> main.c <span class="at">-o</span> main.o  <span class="co"># No debug info</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:fallback.json <span class="dt">\</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> myapp</span></code></pre></div>
<h3 id="dwarf-properties">DWARF Properties</h3>
<p>Heimdall adds custom properties to CycloneDX SBOMs:</p>
<ul>
<li><code>heimdall:source-files</code>: Comma-separated list of source files</li>
<li><code>heimdall:functions</code>: Comma-separated list of function names</li>
<li><code>heimdall:compile-units</code>: Comma-separated list of compile units</li>
<li><code>heimdall:contains-debug-info</code>: Boolean indicating DWARF presence</li>
</ul>
<h2 id="sbom-validation-and-tools">SBOM Validation and Tools</h2>
<p>Heimdall includes comprehensive validation tools to ensure your SBOMs are standards compliant.</p>
<h3 id="command-line-validation-tool">Command-Line Validation Tool</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate a single SBOM</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--validate</span> myapp.cyclonedx.json</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--validate</span> myapp.spdx.json</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare two SBOMs</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--compare</span> sbom1.json sbom2.json</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate diff report</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--diff</span> sbom1.json sbom2.json <span class="at">--output</span> diff-report.txt</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge multiple SBOMs</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--merge</span> sbom1.json sbom2.json sbom3.json <span class="at">--output</span> merged.json</span></code></pre></div>
<h3 id="validation-scripts">Validation Scripts</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic validation (JSON syntax, SPDX structure)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/validate_sboms.sh</span> build</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced validation (schema validation, detailed reporting)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> scripts/validate_sboms_online.py build</span></code></pre></div>
<h3 id="validation-features">Validation Features</h3>
<ul>
<li><strong>JSON syntax validation</strong> for CycloneDX and SPDX 3.0 files</li>
<li><strong>SPDX structure validation</strong> (supports both 2.3 tag-value and 3.0 JSON formats)</li>
<li><strong>Required field checking</strong> for both standards</li>
<li><strong>Detailed validation logs</strong> and summary reports</li>
<li><strong>SBOM comparison</strong> and diff generation</li>
<li><strong>SBOM merging</strong> capabilities</li>
</ul>
<h3 id="cicd-integration">CI/CD Integration</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub Actions example</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Generate SBOMs</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">  run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    make build-test-sbom</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Validate SBOMs</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">  run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    ./scripts/validate_sboms.sh build</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload SBOMs</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v3</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> sboms</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> build/sboms/</span></span></code></pre></div>
<h2 id="build-system-integration">Build System Integration</h2>
<h3 id="cmake-integration">CMake Integration</h3>
<h4 id="basic-integration">Basic Integration</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Heimdall</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">find_library</span>(HEIMDALL_LLD heimdall-lld <span class="ot">REQUIRED</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SBOM generation to target</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="kw">target_link_options</span>(myapp <span class="ot">PRIVATE</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LINKER:--plugin-opt=load:</span><span class="dv">${HEIMDALL_LLD}</span><span class="st">&quot;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LINKER:--plugin-opt=sbom-output:</span><span class="dv">${CMAKE_BINARY_DIR}</span><span class="st">/myapp-sbom.json&quot;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LINKER:--plugin-opt=format:cyclonedx&quot;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable debug information for DWARF extraction</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="kw">target_compile_options</span>(myapp <span class="ot">PRIVATE</span> -g)</span></code></pre></div>
<h4 id="advanced-integration-with-version-selection">Advanced Integration with Version Selection</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to add SBOM generation</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span>(add_sbom_generation target)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">find_library</span>(HEIMDALL_LLD heimdall-lld <span class="ot">REQUIRED</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CycloneDX 1.6 (default)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">target_link_options</span>(<span class="dv">${target}</span> <span class="ot">PRIVATE</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=load:</span><span class="dv">${HEIMDALL_LLD}</span><span class="st">&quot;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=sbom-output:</span><span class="dv">${CMAKE_BINARY_DIR}</span><span class="st">/</span><span class="dv">${target}</span><span class="st">-cyclonedx.json&quot;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=format:cyclonedx&quot;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=cyclonedx-version:1.6&quot;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SPDX 3.0 JSON</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">target_link_options</span>(<span class="dv">${target}</span> <span class="ot">PRIVATE</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=load:</span><span class="dv">${HEIMDALL_LLD}</span><span class="st">&quot;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=sbom-output:</span><span class="dv">${CMAKE_BINARY_DIR}</span><span class="st">/</span><span class="dv">${target}</span><span class="st">-spdx.json&quot;</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=format:spdx&quot;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=spdx-version:3.0&quot;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enable debug information</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">target_compile_options</span>(<span class="dv">${target}</span> <span class="ot">PRIVATE</span> -g)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="kw">endfunction</span>()</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="kw">add_executable</span>(myapp main.c)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="fu">add_sbom_generation</span>(myapp)</span></code></pre></div>
<h4 id="conditional-integration">Conditional Integration</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only add SBOM generation if Heimdall is available</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">find_library</span>(HEIMDALL_LLD heimdall-lld)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span>(HEIMDALL_LLD)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">target_link_options</span>(myapp <span class="ot">PRIVATE</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=load:</span><span class="dv">${HEIMDALL_LLD}</span><span class="st">&quot;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=sbom-output:</span><span class="dv">${CMAKE_BINARY_DIR}</span><span class="st">/myapp-sbom.json&quot;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LINKER:--plugin-opt=format:cyclonedx&quot;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">target_compile_options</span>(myapp <span class="ot">PRIVATE</span> -g)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">message</span>(<span class="ot">STATUS</span> <span class="st">&quot;SBOM generation enabled for myapp&quot;</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span>()</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">message</span>(<span class="ot">WARNING</span> <span class="st">&quot;Heimdall not found, SBOM generation disabled&quot;</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="kw">endif</span>()</span></code></pre></div>
<h3 id="makefile-integration">Makefile Integration</h3>
<h4 id="basic-makefile">Basic Makefile</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC </span><span class="ch">=</span><span class="st"> gcc</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dt">LD </span><span class="ch">=</span><span class="st"> ld.lld</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dt">HEIMDALL_PLUGIN </span><span class="ch">=</span><span class="st"> ./heimdall-lld.dylib</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS </span><span class="ch">=</span><span class="st"> -g -Wall</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="dt">LDFLAGS </span><span class="ch">=</span><span class="st"> --plugin-opt=load:</span><span class="ch">$(</span><span class="dt">HEIMDALL_PLUGIN</span><span class="ch">)</span><span class="st"> </span><span class="ch">\</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">          --plugin-opt=sbom-output:</span><span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span><span class="st">-sbom.json </span><span class="ch">\</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">          --plugin-opt=format:cyclonedx</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="dt">TARGET </span><span class="ch">=</span><span class="st"> myapp</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="dt">SOURCES </span><span class="ch">=</span><span class="st"> main.c utils.c</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="dt">OBJECTS </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="dt">SOURCES</span><span class="kw">:</span><span class="ss">.c</span><span class="kw">=</span><span class="ss">.o</span><span class="ch">)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="dv">$(TARGET):</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">OBJECTS</span><span class="ch">)</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">LD</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">LDFLAGS</span><span class="ch">)</span> <span class="ch">$^</span> -o <span class="ch">$@</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="dv">%.o:</span><span class="dt"> %.c</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">CC</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">CFLAGS</span><span class="ch">)</span> -c <span class="ch">$&lt;</span> -o <span class="ch">$@</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    rm -f <span class="ch">$(</span><span class="dt">OBJECTS</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>-sbom.json</span></code></pre></div>
<h4 id="advanced-makefile-with-multiple-formats">Advanced Makefile with Multiple Formats</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC </span><span class="ch">=</span><span class="st"> gcc</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="dt">LD </span><span class="ch">=</span><span class="st"> ld.lld</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="dt">HEIMDALL_PLUGIN </span><span class="ch">=</span><span class="st"> ./heimdall-lld.dylib</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS </span><span class="ch">=</span><span class="st"> -g -Wall</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="dt">TARGET </span><span class="ch">=</span><span class="st"> myapp</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="dt">SOURCES </span><span class="ch">=</span><span class="st"> main.c utils.c</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="dt">OBJECTS </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="dt">SOURCES</span><span class="kw">:</span><span class="ss">.c</span><span class="kw">=</span><span class="ss">.o</span><span class="ch">)</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SBOM generation targets</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="ot">.PHONY:</span><span class="dt"> sbom-cyclonedx sbom-spdx sbom-all</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="dv">$(TARGET):</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">OBJECTS</span><span class="ch">)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">LD</span><span class="ch">)</span> --plugin-opt=load:<span class="ch">$(</span><span class="dt">HEIMDALL_PLUGIN</span><span class="ch">)</span> <span class="ch">\</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=sbom-output:<span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>-cyclonedx.json <span class="ch">\</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=format:cyclonedx <span class="ch">\</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=cyclonedx-version:1.6 <span class="ch">\</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>          <span class="ch">$^</span> -o <span class="ch">$@</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="dv">sbom-cyclonedx:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="ch">@</span><span class="fu">echo </span><span class="st">&quot;Generated CycloneDX 1.6 SBOM: </span><span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span><span class="st">-cyclonedx.json&quot;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="dv">sbom-spdx:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">OBJECTS</span><span class="ch">)</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">LD</span><span class="ch">)</span> --plugin-opt=load:<span class="ch">$(</span><span class="dt">HEIMDALL_PLUGIN</span><span class="ch">)</span> <span class="ch">\</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=sbom-output:<span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>-spdx.json <span class="ch">\</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=format:spdx <span class="ch">\</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>          --plugin-opt=spdx-version:3.0 <span class="ch">\</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>          <span class="ch">$^</span> -o <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>-spdx</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="ch">@</span><span class="fu">echo </span><span class="st">&quot;Generated SPDX 3.0 SBOM: </span><span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span><span class="st">-spdx.json&quot;</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="dv">sbom-all:</span><span class="dt"> sbom-cyclonedx sbom-spdx</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="ch">@</span><span class="fu">echo </span><span class="st">&quot;Generated all SBOM formats&quot;</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="dv">%.o:</span><span class="dt"> %.c</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="ch">$(</span><span class="dt">CC</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">CFLAGS</span><span class="ch">)</span> -c <span class="ch">$&lt;</span> -o <span class="ch">$@</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    rm -f <span class="ch">$(</span><span class="dt">OBJECTS</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TARGET</span><span class="ch">)</span>-spdx *.json</span></code></pre></div>
<h3 id="meson-integration">Meson Integration</h3>
<pre class="meson"><code># meson.build
project(&#39;myapp&#39;, &#39;c&#39;)

# Find Heimdall
heimdall_dep = dependency(&#39;heimdall-lld&#39;, required: false)

# Create executable
myapp = executable(&#39;myapp&#39;, &#39;main.c&#39;, &#39;utils.c&#39;,
    c_args: [&#39;-g&#39;],  # Enable debug info for DWARF
    link_args: heimdall_dep.found() ? [
        &#39;--plugin-opt=load:&#39; + heimdall_dep.get_variable(&#39;plugin_path&#39;),
        &#39;--plugin-opt=sbom-output=@OUTPUT@-sbom.json&#39;,
        &#39;--plugin-opt=format=cyclonedx&#39;
    ] : []
)

# Add custom target for SBOM validation
if heimdall_dep.found()
    run_target(&#39;validate-sbom&#39;,
        command: [&#39;heimdall-validate&#39;, &#39;--validate&#39;, myapp.full_path() + &#39;-sbom.json&#39;]
    )
endif()</code></pre>
<h2 id="command-line-integration">Command-Line Integration</h2>
<h3 id="shell-scripts">Shell Scripts</h3>
<h4 id="simple-build-script">Simple Build Script</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># build-with-sbom.sh</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="va">TARGET</span><span class="op">=</span><span class="va">${1</span><span class="op">:-</span>myapp<span class="va">}</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="va">FORMAT</span><span class="op">=</span><span class="va">${2</span><span class="op">:-</span>cyclonedx<span class="va">}</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="va">VERSION</span><span class="op">=</span><span class="va">${3</span><span class="op">:-</span>1.6<span class="va">}</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Building </span><span class="va">$TARGET</span><span class="st"> with </span><span class="va">$FORMAT</span><span class="st"> </span><span class="va">$VERSION</span><span class="st"> SBOM...&quot;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile with debug info</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-g</span> <span class="at">-c</span> <span class="pp">*</span>.c</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Link with SBOM generation</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$FORMAT</span><span class="st">&quot;</span> <span class="ot">=</span> <span class="st">&quot;cyclonedx&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:<span class="va">$TARGET</span>-<span class="va">$FORMAT</span>.json <span class="dt">\</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>format:<span class="va">$FORMAT</span> <span class="dt">\</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>cyclonedx-version:<span class="va">$VERSION</span> <span class="dt">\</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>           <span class="pp">*</span>.o <span class="at">-o</span> <span class="va">$TARGET</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$FORMAT</span><span class="st">&quot;</span> <span class="ot">=</span> <span class="st">&quot;spdx&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:<span class="va">$TARGET</span>-<span class="va">$FORMAT</span>.json <span class="dt">\</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>format:<span class="va">$FORMAT</span> <span class="dt">\</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">--plugin-opt</span><span class="op">=</span>spdx-version:<span class="va">$VERSION</span> <span class="dt">\</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>           <span class="pp">*</span>.o <span class="at">-o</span> <span class="va">$TARGET</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Generated </span><span class="va">$TARGET</span><span class="st">-</span><span class="va">$FORMAT</span><span class="st">.json&quot;</span></span></code></pre></div>
<h4 id="advanced-build-script-with-validation">Advanced Build Script with Validation</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># build-and-validate.sh</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="va">TARGET</span><span class="op">=</span><span class="va">${1</span><span class="op">:-</span>myapp<span class="va">}</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="va">VALIDATE</span><span class="op">=</span><span class="va">${2</span><span class="op">:-</span>true<span class="va">}</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Building </span><span class="va">$TARGET</span><span class="st">...&quot;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Build with both formats</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="ex">./build-with-sbom.sh</span> <span class="va">$TARGET</span> cyclonedx 1.6</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="ex">./build-with-sbom.sh</span> <span class="va">$TARGET</span> spdx 3.0</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$VALIDATE</span><span class="st">&quot;</span> <span class="ot">=</span> <span class="st">&quot;true&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Validating SBOMs...&quot;</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validate CycloneDX</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ex">./build/bin/heimdall-validate</span> <span class="at">--validate</span> <span class="va">$TARGET</span>-cyclonedx.json<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;✅ CycloneDX SBOM is valid&quot;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;❌ CycloneDX SBOM validation failed&quot;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">exit</span> 1</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validate SPDX</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ex">./build/bin/heimdall-validate</span> <span class="at">--validate</span> <span class="va">$TARGET</span>-spdx.json<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;✅ SPDX SBOM is valid&quot;</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;❌ SPDX SBOM validation failed&quot;</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">exit</span> 1</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compare formats</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Comparing SBOM formats...&quot;</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="ex">./build/bin/heimdall-validate</span> <span class="at">--compare</span> <span class="va">$TARGET</span>-cyclonedx.json <span class="va">$TARGET</span>-spdx.json</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Build complete!&quot;</span></span></code></pre></div>
<h3 id="python-integration">Python Integration</h3>
<h4 id="build-script-with-python">Build Script with Python</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># build_sbom.py</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_command(cmd, check<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Run a command and return the result.&quot;&quot;&quot;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> subprocess.run(cmd, shell<span class="op">=</span><span class="va">True</span>, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> check <span class="kw">and</span> result.returncode <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Command failed: </span><span class="sc">{</span>cmd<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Error: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_with_sbom(target, format_type<span class="op">=</span><span class="st">&quot;cyclonedx&quot;</span>, version<span class="op">=</span><span class="st">&quot;1.6&quot;</span>):</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Build a target with SBOM generation.&quot;&quot;&quot;</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Building </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> with </span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>version<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compile with debug info</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    run_command(<span class="st">&quot;gcc -g -c *.c&quot;</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Build SBOM command</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> format_type <span class="op">==</span> <span class="st">&quot;cyclonedx&quot;</span>:</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        cmd <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;ld.lld --plugin-opt=load:./heimdall-lld.dylib </span><span class="ch">\\</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=sbom-output:</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss">.json </span><span class="ch">\\</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=format:</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss"> </span><span class="ch">\\</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=cyclonedx-version:</span><span class="sc">{</span>version<span class="sc">}</span><span class="ss"> </span><span class="ch">\\</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="ss">               *.o -o </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> format_type <span class="op">==</span> <span class="st">&quot;spdx&quot;</span>:</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>        cmd <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;ld.lld --plugin-opt=load:./heimdall-lld.dylib </span><span class="ch">\\</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=sbom-output:</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss">.json </span><span class="ch">\\</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=format:</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss"> </span><span class="ch">\\</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="ss">               --plugin-opt=spdx-version:</span><span class="sc">{</span>version<span class="sc">}</span><span class="ss"> </span><span class="ch">\\</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a><span class="ss">               *.o -o </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    run_command(cmd)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Generated </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss">.json&quot;</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_sbom(sbom_file):</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Validate an SBOM file.&quot;&quot;&quot;</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Validating </span><span class="sc">{</span>sbom_file<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> run_command(<span class="ss">f&quot;./build/bin/heimdall-validate --validate </span><span class="sc">{</span>sbom_file<span class="sc">}</span><span class="ss">&quot;</span>, check<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;✅ </span><span class="sc">{</span>sbom_file<span class="sc">}</span><span class="ss"> is valid&quot;</span>)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;❌ </span><span class="sc">{</span>sbom_file<span class="sc">}</span><span class="ss"> validation failed&quot;</span>)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> sys.argv[<span class="dv">1</span>] <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">&quot;myapp&quot;</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Build with both formats</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>    build_with_sbom(target, <span class="st">&quot;cyclonedx&quot;</span>, <span class="st">&quot;1.6&quot;</span>)</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>    build_with_sbom(target, <span class="st">&quot;spdx&quot;</span>, <span class="st">&quot;3.0&quot;</span>)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validate SBOMs</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>    cyclonedx_file <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-cyclonedx.json&quot;</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>    spdx_file <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-spdx.json&quot;</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    cyclonedx_valid <span class="op">=</span> validate_sbom(cyclonedx_file)</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    spdx_valid <span class="op">=</span> validate_sbom(spdx_file)</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> (cyclonedx_valid <span class="kw">and</span> spdx_valid):</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Build and validation complete!&quot;</span>)</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="plugin-not-found">Plugin Not Found</h4>
<pre><code>Error: Could not load plugin</code></pre>
<p><strong>Solution</strong>: Ensure the plugin path is correct and the plugin is built for your platform.</p>
<h4 id="missing-dependencies">Missing Dependencies</h4>
<pre><code>Error: LLVM libraries not found</code></pre>
<p><strong>Solution</strong>: Install LLVM development packages.</p>
<h4 id="gold-linker-not-found-linux">Gold Linker Not Found (Linux)</h4>
<pre><code>Warning: Gold linker not found</code></pre>
<p><strong>Solution</strong>: Install <code>binutils-gold</code> package for your distribution.</p>
<h4 id="gold-not-available-on-macos">Gold Not Available on macOS</h4>
<pre><code>Warning: Gold linker not found</code></pre>
<p><strong>Solution</strong>: This is expected on macOS. Use LLD linker instead.</p>
<h4 id="permission-denied">Permission Denied</h4>
<pre><code>Error: Cannot write to output file</code></pre>
<p><strong>Solution</strong>: Check write permissions for the output directory.</p>
<h4 id="openssl-deprecation-warnings">OpenSSL Deprecation Warnings</h4>
<pre><code>Warning: &#39;SHA256_Init&#39; is deprecated</code></pre>
<p><strong>Solution</strong>: These warnings are harmless and the build will succeed.</p>
<h4 id="dwarf-extraction-not-working">DWARF Extraction Not Working</h4>
<pre><code>Warning: No DWARF debug information found</code></pre>
<p><strong>Solution</strong>: Ensure you’re compiling with debug information (<code>-g</code> flag) and using LLVM 19+ for best DWARF support.</p>
<h3 id="platform-specific-issues">Platform-Specific Issues</h3>
<h4 id="macos">macOS</h4>
<ul>
<li><strong>Gold plugin not built</strong>: This is expected behavior. Gold is not available on macOS.</li>
<li><strong>LLD path issues</strong>: Ensure LLVM is properly installed via Homebrew and PATH is set correctly.</li>
<li><strong>DWARF support</strong>: Full DWARF support available with Homebrew LLVM.</li>
</ul>
<h4 id="linux">Linux</h4>
<ul>
<li><strong>Gold not found</strong>: Install <code>binutils-gold</code> package for your distribution.</li>
<li><strong>Plugin loading errors</strong>: Ensure Gold was built with plugin support enabled.</li>
<li><strong>DWARF support</strong>: Full DWARF support available with LLVM 19+.</li>
</ul>
<h3 id="debug-mode">Debug Mode</h3>
<p>Enable verbose output to see detailed processing information:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LLD</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.lld</span> <span class="at">--plugin-opt</span><span class="op">=</span>load:./heimdall-lld.dylib <span class="dt">\</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>sbom-output:debug-sbom.json <span class="dt">\</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">--plugin-opt</span><span class="op">=</span>verbose <span class="dt">\</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>       main.o <span class="at">-o</span> debug-app</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gold (Linux only)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="ex">ld.gold</span> <span class="at">--plugin</span> ./heimdall-gold.so <span class="dt">\</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">--plugin-opt</span> sbom-output=debug-sbom.json <span class="dt">\</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">--plugin-opt</span> verbose <span class="dt">\</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        main.o <span class="at">-o</span> debug-app</span></code></pre></div>
<h3 id="logging-levels">Logging Levels</h3>
<p>Heimdall provides different log levels:</p>
<ul>
<li><strong>INFO</strong>: General processing information</li>
<li><strong>WARNING</strong>: Non-critical issues</li>
<li><strong>ERROR</strong>: Critical errors</li>
<li><strong>DEBUG</strong>: Detailed debugging information (requires debug build)</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<h3 id="sbom-generation">SBOM Generation</h3>
<ol type="1">
<li><p><strong>Always compile with debug information</strong> for comprehensive DWARF extraction:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-g</span> <span class="at">-c</span> source.c <span class="at">-o</span> source.o</span></code></pre></div></li>
<li><p><strong>Use appropriate SBOM format versions</strong> for your toolchain:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For modern tools</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.6</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=spdx-version:3.0</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For legacy compatibility</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=cyclonedx-version:1.4</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=spdx-version:2.3</span></span></code></pre></div></li>
<li><p><strong>Include system libraries</strong> when needed for complete dependency tracking:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--plugin-opt=include-system-libs</span></span></code></pre></div></li>
<li><p><strong>Validate generated SBOMs</strong> to ensure standards compliance:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--validate</span> myapp.cyclonedx.json</span></code></pre></div></li>
</ol>
<h3 id="build-system-integration-1">Build System Integration</h3>
<ol type="1">
<li><p><strong>Use conditional integration</strong> to handle missing Heimdall gracefully:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">find_library</span>(HEIMDALL_LLD heimdall-lld)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span>(HEIMDALL_LLD)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add SBOM generation</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="kw">endif</span>()</span></code></pre></div></li>
<li><p><strong>Enable debug information</strong> in your build system:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">target_compile_options</span>(myapp <span class="ot">PRIVATE</span> -g)</span></code></pre></div></li>
<li><p><strong>Generate multiple formats</strong> for maximum compatibility:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate both CycloneDX and SPDX</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_sbom_generation</span>(myapp)</span></code></pre></div></li>
</ol>
<h3 id="cicd-integration-1">CI/CD Integration</h3>
<ol type="1">
<li><p><strong>Validate SBOMs in CI/CD</strong> to catch issues early:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Validate SBOMs</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">run</span><span class="kw">:</span><span class="at"> ./scripts/validate_sboms.sh build</span></span></code></pre></div></li>
<li><p><strong>Upload SBOMs as artifacts</strong> for later analysis:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload SBOMs</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v3</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> sboms</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> build/sboms/</span></span></code></pre></div></li>
<li><p><strong>Compare SBOMs across builds</strong> to track changes:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./build/bin/heimdall-validate</span> <span class="at">--diff</span> previous.json current.json</span></code></pre></div></li>
</ol>
<h3 id="performance-optimization">Performance Optimization</h3>
<ol type="1">
<li><p><strong>Use appropriate linker</strong> for your platform:</p>
<ul>
<li>LLD: Better on macOS, good on Linux</li>
<li>Gold: Better on Linux, not available on macOS</li>
</ul></li>
<li><p><strong>Disable verbose output</strong> in production builds:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove --plugin-opt=verbose for production</span></span></code></pre></div></li>
<li><p><strong>Cache build artifacts</strong> to avoid regenerating SBOMs unnecessarily.</p></li>
</ol>
<h3 id="security-considerations">Security Considerations</h3>
<ol type="1">
<li><p><strong>Review generated SBOMs</strong> for sensitive information before distribution.</p></li>
<li><p><strong>Validate SBOMs</strong> against known vulnerabilities:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use external tools for vulnerability scanning</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="ex">grype</span> sbom:./myapp.cyclonedx.json</span></code></pre></div></li>
<li><p><strong>Sign SBOMs</strong> when distributing to ensure integrity.</p></li>
</ol>
<h3 id="documentation">Documentation</h3>
<ol type="1">
<li><p><strong>Document your SBOM generation process</strong> in your project README.</p></li>
<li><p><strong>Include SBOM examples</strong> in your documentation.</p></li>
<li><p><strong>Provide validation scripts</strong> for your team to use.</p></li>
<li><p><strong>Update CI/CD documentation</strong> to include SBOM generation steps.</p></li>
</ol>
<hr />
<p>For more information, see the <a href="../README.md">main README</a> and <a href="../docs/api.md">API documentation</a>.</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>C++11 compatible compiler (GCC 4.8+ or Clang 3.3+ recommended)</li>
<li>C++14, C++17, or C++23 compatible compiler for enhanced features</li>
<li>CMake 3.16+</li>
<li>OpenSSL</li>
<li>LLVM 19 (for DWARF support)</li>
<li>libelf (for ELF parsing)</li>
<li>BFD (for Gold plugin)</li>
</ul>
<h3 id="c-standard-support-1">C++ Standard Support</h3>
<p>Heimdall supports multiple C++ standards with different feature sets:</p>
<p><strong>C++11 (Minimum):</strong> - Basic functionality - Uses <code>.find() != std::string::npos</code> for string operations - Compatible with older compilers</p>
<p><strong>C++14/17/23 (Enhanced features):</strong> - Uses modern features like <code>std::string::contains()</code> (C++23) - <code>starts_with</code>, <code>ends_with</code> (C++20+) - Future support for <code>std::format</code>, <code>std::print</code>, and more</p>
<p>If you encounter build errors, ensure your compiler supports the selected C++ standard and that CMake is passing the correct <code>-std=c++XX</code> flag to your compiler.</p>
</body>
</html>
