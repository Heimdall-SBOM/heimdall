<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>heimdall-developers-guide</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Note:</strong> To generate HTML and PDF versions of this guide, install <a href="https://pandoc.org/">pandoc</a> and <a href="https://www.tug.org/texlive/">pdflatex</a> (from TeX Live):</td>
</tr>
<tr class="even">
<td><code>sh sudo dnf install -y pandoc texlive</code></td>
</tr>
<tr class="odd">
<td>Then use the CMake targets <code>docs-html</code> and <code>docs-pdf</code>.</td>
</tr>
</tbody>
</table>
<h1 id="heimdall-developers-guide">Heimdall Developer’s Guide</h1>
<hr />
<h2 id="product-overview">1. Product Overview</h2>
<p><strong>Heimdall</strong> is a cross-platform, extensible Software Bill of Materials (SBOM) generator for C/C++ binaries. It integrates with modern linkers (GNU Gold and LLVM LLD) to extract rich metadata—including version, license, symbol, section, and debug information—directly from build artifacts. Heimdall supports both SPDX and CycloneDX SBOM formats, and is designed for security, compliance, and supply chain transparency.</p>
<p><strong>Key Features:</strong> - Generates SBOMs in SPDX (2.3/3.0) and CycloneDX (1.4/1.5/1.6) formats - Deep binary analysis: symbols, sections, dependencies, debug info (DWARF) - Plugin-based: supports both GNU Gold and LLVM LLD linkers - CLI tools for validation, comparison, and merging - Extensible, modern C++ codebase</p>
<hr />
<h2 id="architecture-overview">2. Architecture Overview</h2>
<p>Heimdall is organized into several core components: - <strong>Core Library</strong>: Metadata extraction, SBOM generation, and component modeling - <strong>Plugins</strong>: LLD and Gold plugins for integration with linkers - <strong>CLI Tools</strong>: Validation, comparison, and merging utilities - <strong>Build Scripts</strong>: Integration with CMake, Make, and shell wrappers</p>
<h3 id="high-level-architecture-diagram">2.1 High-Level Architecture Diagram</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode dot"><code class="sourceCode dot"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Heimdall High-Level Architecture</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">digraph</span> <span class="va">HeimdallArch</span> <span class="ot">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="at">rankdir</span><span class="ot">=</span><span class="va">LR</span><span class="ot">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">node</span><span class="co"> </span><span class="ot">[</span><span class="at">shape</span><span class="ot">=</span><span class="va">box</span><span class="co">, </span><span class="at">style</span><span class="ot">=</span><span class="va">filled</span><span class="co">, </span><span class="at">fillcolor</span><span class="ot">=</span><span class="st">&quot;#e0e7ef&quot;</span><span class="ot">];</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">subgraph</span><span class="co"> </span><span class="va">cluster_core</span><span class="co"> </span><span class="ot">{</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;Heimdall Core Library&quot;</span><span class="ot">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">SBOMGenerator</span><span class="ot">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">MetadataExtractor</span><span class="ot">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">ComponentInfo</span><span class="ot">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">DWARFExtractor</span><span class="ot">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="ot">}</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">subgraph</span><span class="co"> </span><span class="va">cluster_plugins</span><span class="co"> </span><span class="ot">{</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;Plugins&quot;</span><span class="ot">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">LLDPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;LLD Plugin (heimdall-lld)&quot;</span><span class="ot">];</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">GoldPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;Gold Plugin (heimdall-gold)&quot;</span><span class="ot">];</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="ot">}</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">subgraph</span><span class="co"> </span><span class="va">cluster_cli</span><span class="co"> </span><span class="ot">{</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;CLI Tools&quot;</span><span class="ot">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">        </span><span class="va">Validate</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;heimdall-validate&quot;</span><span class="ot">];</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="ot">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">BuildSystem</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;Build System (CMake/Make)&quot;</span><span class="ot">];</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">Linker</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;Linker (LLD/Gold)&quot;</span><span class="ot">];</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">User</span><span class="co"> </span><span class="ot">[</span><span class="at">shape</span><span class="ot">=</span><span class="va">ellipse</span><span class="co">, </span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;User/CI&quot;</span><span class="ot">];</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">User</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">BuildSystem</span><span class="ot">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">BuildSystem</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">Linker</span><span class="ot">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">Linker</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">LLDPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;(LLD)&quot;</span><span class="ot">];</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">Linker</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">GoldPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;(Gold)&quot;</span><span class="ot">];</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">LLDPlugin</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">SBOMGenerator</span><span class="ot">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">GoldPlugin</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">SBOMGenerator</span><span class="ot">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">SBOMGenerator</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">MetadataExtractor</span><span class="ot">;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">MetadataExtractor</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">DWARFExtractor</span><span class="ot">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">SBOMGenerator</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">ComponentInfo</span><span class="ot">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">SBOMGenerator</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">Validate</span><span class="ot">;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">Validate</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">User</span><span class="ot">;</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="ot">}</span></span></code></pre></div>
<hr />
<h2 id="plugin-system">3. Plugin System</h2>
<h3 id="plugin-interface">3.1 Plugin Interface</h3>
<p>Heimdall defines a common <code>PluginInterface</code> for all linker plugins. This interface ensures that both LLD and Gold plugins can: - Process input files and libraries - Extract symbols, sections, and debug info - Generate SBOMs in multiple formats - Support configuration (output path, format, verbosity, etc.)</p>
<h3 id="lld-plugin">3.2 LLD Plugin</h3>
<h4 id="architecture">3.2.1 Architecture</h4>
<p>The LLD plugin (<code>heimdall-lld</code>) is designed to work with LLVM’s LLD linker. It provides hooks for file and library processing, and integrates with the core SBOM generation logic.</p>
<h4 id="why-a-wrapper-is-required">3.2.2 Why a Wrapper is Required</h4>
<p>LLD does not natively support the same plugin API as GNU Gold. Instead, Heimdall uses a <strong>wrapper script</strong> approach: - The build system invokes a wrapper script instead of LLD directly. - The script runs LLD to link the binary. - After linking, the script loads the Heimdall plugin and calls its SBOM generation functions.</p>
<p><strong>Rationale:</strong> - No need to patch or recompile LLD - Works with any stock LLD installation - Simple to maintain and deploy</p>
<p><strong>Limitations:</strong> - The plugin is not called during the linking process, so per-file or per-library callbacks are not available. - The user must use the wrapper script instead of invoking LLD directly.</p>
<h4 id="lld-plugin-integration-diagram">3.2.3 LLD Plugin Integration Diagram</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode dot"><code class="sourceCode dot"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// LLD Plugin Wrapper Integration</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">digraph</span> <span class="va">LLDWrapper</span> <span class="ot">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="at">rankdir</span><span class="ot">=</span><span class="va">LR</span><span class="ot">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">node</span><span class="co"> </span><span class="ot">[</span><span class="at">shape</span><span class="ot">=</span><span class="va">box</span><span class="co">, </span><span class="at">style</span><span class="ot">=</span><span class="va">filled</span><span class="co">, </span><span class="at">fillcolor</span><span class="ot">=</span><span class="st">&quot;#e0e7ef&quot;</span><span class="ot">];</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">User</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">WrapperScript</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;invoke build&quot;</span><span class="ot">];</span><span class="co"> </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">WrapperScript</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">LLD</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;link binary&quot;</span><span class="ot">];</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">WrapperScript</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">HeimdallLLDPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;generate SBOM&quot;</span><span class="ot">];</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">HeimdallLLDPlugin</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">HeimdallCore</span><span class="ot">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="ot">}</span></span></code></pre></div>
<h4 id="deeper-integration-not-default">3.2.4 Deeper Integration (Not Default)</h4>
<p>A custom-patched LLD could call Heimdall hooks during linking, but this requires maintaining a forked LLD and is not recommended for most users.</p>
<h3 id="gold-plugin">3.3 Gold Plugin</h3>
<h4 id="architecture-1">3.3.1 Architecture</h4>
<p>The Gold plugin (<code>heimdall-gold</code>) integrates directly with GNU Gold’s plugin API. Gold calls plugin hooks during the linking process, allowing Heimdall to: - Process each input file and library as it is linked - Extract metadata in real time - Generate SBOMs automatically at the end of linking</p>
<h4 id="gold-plugin-integration-diagram">3.3.2 Gold Plugin Integration Diagram</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode dot"><code class="sourceCode dot"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Gold Plugin Integration</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">digraph</span> <span class="va">GoldPlugin</span> <span class="ot">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="at">rankdir</span><span class="ot">=</span><span class="va">LR</span><span class="ot">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="kw">node</span><span class="co"> </span><span class="ot">[</span><span class="at">shape</span><span class="ot">=</span><span class="va">box</span><span class="co">, </span><span class="at">style</span><span class="ot">=</span><span class="va">filled</span><span class="co">, </span><span class="at">fillcolor</span><span class="ot">=</span><span class="st">&quot;#e0e7ef&quot;</span><span class="ot">];</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">User</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">BuildSystem</span><span class="ot">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">BuildSystem</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">Gold</span><span class="ot">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">Gold</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">HeimdallGoldPlugin</span><span class="co"> </span><span class="ot">[</span><span class="at">label</span><span class="ot">=</span><span class="st">&quot;plugin API calls&quot;</span><span class="ot">];</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">HeimdallGoldPlugin</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">HeimdallCore</span><span class="ot">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="ot">}</span></span></code></pre></div>
<hr />
<h2 id="api-reference">4. API Reference</h2>
<h3 id="core-classes">4.1 Core Classes</h3>
<h4 id="sbomgenerator">SBOMGenerator</h4>
<ul>
<li>Responsible for collecting component information and generating SBOMs in various formats (SPDX, CycloneDX)</li>
<li>Key methods:
<ul>
<li><code>processComponent(const ComponentInfo&amp;)</code></li>
<li><code>generateSBOM()</code></li>
<li><code>setOutputPath(const std::string&amp;)</code></li>
<li><code>setFormat(const std::string&amp;)</code></li>
<li><code>setCycloneDXVersion(const std::string&amp;)</code></li>
<li><code>setSPDXVersion(const std::string&amp;)</code></li>
<li><code>getComponentCount() const</code></li>
<li><code>hasComponent(const std::string&amp;) const</code></li>
<li><code>printStatistics() const</code></li>
</ul></li>
</ul>
<h4 id="metadataextractor">MetadataExtractor</h4>
<ul>
<li>Extracts metadata from binary files (symbols, sections, dependencies, debug info, package manager info)</li>
<li>Key methods:
<ul>
<li><code>extractMetadata(ComponentInfo&amp;)</code></li>
<li><code>extractVersionInfo(ComponentInfo&amp;)</code></li>
<li><code>extractLicenseInfo(ComponentInfo&amp;)</code></li>
<li><code>extractSymbolInfo(ComponentInfo&amp;)</code></li>
<li><code>extractSectionInfo(ComponentInfo&amp;)</code></li>
<li><code>extractDebugInfo(ComponentInfo&amp;)</code></li>
<li><code>extractDependencyInfo(ComponentInfo&amp;)</code></li>
<li><code>setVerbose(bool)</code></li>
<li><code>setExtractDebugInfo(bool)</code></li>
</ul></li>
</ul>
<h4 id="componentinfo">ComponentInfo</h4>
<ul>
<li>Represents a software component (binary, library, etc.)</li>
<li>Fields:
<ul>
<li><code>name</code>, <code>filePath</code>, <code>version</code>, <code>supplier</code>, <code>downloadLocation</code>, <code>homepage</code>, <code>license</code>, <code>checksum</code>, <code>packageManager</code>, <code>fileType</code>, <code>fileSize</code>, <code>symbols</code>, <code>sections</code>, <code>dependencies</code>, <code>sourceFiles</code>, <code>functions</code>, <code>compileUnits</code>, <code>wasProcessed</code>, <code>processingError</code>, <code>detectedBy</code>, <code>isSystemLibrary</code>, <code>containsDebugInfo</code>, <code>isStripped</code></li>
</ul></li>
<li>Key methods:
<ul>
<li><code>addSymbol(const SymbolInfo&amp;)</code></li>
<li><code>addSection(const SectionInfo&amp;)</code></li>
<li><code>addDependency(const std::string&amp;)</code></li>
<li><code>addSourceFile(const std::string&amp;)</code></li>
<li><code>setVersion(const std::string&amp;)</code></li>
<li><code>setSupplier(const std::string&amp;)</code></li>
<li><code>setDownloadLocation(const std::string&amp;)</code></li>
<li><code>setHomepage(const std::string&amp;)</code></li>
<li><code>setLicense(const std::string&amp;)</code></li>
<li><code>setPackageManager(const std::string&amp;)</code></li>
<li><code>markAsProcessed()</code></li>
<li><code>setProcessingError(const std::string&amp;)</code></li>
</ul></li>
</ul>
<h4 id="dwarfextractor">DWARFExtractor</h4>
<ul>
<li>Extracts DWARF debug information for source file, function, and compile unit tracking</li>
<li>Key methods:
<ul>
<li><code>extractSourceFiles(const std::string&amp;, std::vector&lt;std::string&gt;&amp;)</code></li>
<li><code>extractCompileUnits(const std::string&amp;, std::vector&lt;std::string&gt;&amp;)</code></li>
<li><code>extractFunctions(const std::string&amp;, std::vector&lt;std::string&gt;&amp;)</code></li>
<li><code>extractLineInfo(const std::string&amp;, std::vector&lt;std::string&gt;&amp;)</code></li>
<li><code>hasDWARFInfo(const std::string&amp;)</code></li>
</ul></li>
</ul>
<h3 id="plugin-interfaces">4.2 Plugin Interfaces</h3>
<h4 id="plugininterface">PluginInterface</h4>
<ul>
<li>Abstract base for all plugins</li>
<li>Key methods:
<ul>
<li><code>initialize()</code>, <code>cleanup()</code>, <code>processInputFile()</code>, <code>processLibrary()</code>, <code>processSymbol()</code>, <code>setOutputPath()</code>, <code>setFormat()</code>, <code>setCycloneDXVersion()</code>, <code>setSPDXVersion()</code>, <code>generateSBOM()</code>, <code>setVerbose()</code>, <code>setExtractDebugInfo()</code>, <code>setIncludeSystemLibraries()</code>, <code>getComponentCount() const</code>, <code>printStatistics() const</code></li>
</ul></li>
</ul>
<h4 id="lldadapter-goldadapter">LLDAdapter / GoldAdapter</h4>
<ul>
<li>Concrete implementations for LLD and Gold</li>
<li>Methods mirror the PluginInterface, with additional internal logic for each linker</li>
</ul>
<hr />
<h2 id="build-test-and-extend">5. Build, Test, and Extend</h2>
<h3 id="building-heimdall">5.1 Building Heimdall</h3>
<ul>
<li><p>Use CMake for cross-platform builds</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-S</span> . <span class="at">-B</span> build</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build <span class="at">--parallel</span></span></code></pre></div></li>
<li><p>See <code>docs/heimdall-users-guide.md</code> for platform-specific instructions</p></li>
</ul>
<h3 id="running-tests">5.2 Running Tests</h3>
<ul>
<li><p>Run all tests:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ctest</span> <span class="at">--test-dir</span> build <span class="at">--output-on-failure</span></span></code></pre></div></li>
<li><p>See <code>docs/testing-heimdall.md</code> for more details</p></li>
</ul>
<h3 id="extending-heimdall">5.3 Extending Heimdall</h3>
<ul>
<li>Add new plugins by implementing the <code>PluginInterface</code></li>
<li>Extend metadata extraction by enhancing <code>MetadataExtractor</code> and related helpers</li>
<li>Add new SBOM formats by extending <code>SBOMGenerator</code></li>
</ul>
<hr />
<h2 id="advanced-topics">6. Advanced Topics</h2>
<h3 id="dwarf-extraction-and-fallback">6.1 DWARF Extraction and Fallback</h3>
<ul>
<li>Heimdall uses LLVM’s DWARF libraries for robust debug info extraction</li>
<li>If LLVM extraction fails, a heuristic fallback scans <code>.debug_line</code> for source files</li>
<li>See <code>docs/dwarf-heuristic-rationale.md</code> for details</li>
</ul>
<h3 id="thread-safety-and-limitations">6.2 Thread-Safety and Limitations</h3>
<ul>
<li>LLVM’s DWARF libraries are <strong>not thread-safe</strong>; use only one <code>DWARFExtractor</code> at a time</li>
<li>See <code>docs/heimdall-limitations.md</code> for more</li>
</ul>
<h3 id="best-practices">6.3 Best Practices</h3>
<ul>
<li>Always compile with debug info (<code>-g</code>) for best SBOMs</li>
<li>Use the wrapper script for LLD integration</li>
<li>Validate SBOMs after generation</li>
<li>Review and update build scripts for new plugin versions</li>
</ul>
<hr />
<p>For further details, see the <a href="./heimdall-users-guide.md">Heimdall User’s Guide</a>, <a href="./sbom_validation_guide.md">SBOM Validation Guide</a>, and <a href="./testing-heimdall.md">Testing Guide</a>.</p>
</body>
</html>
